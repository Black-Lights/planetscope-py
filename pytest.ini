[tool:pytest]
# Pytest configuration for planetscope-py v3.0.0

# Test discovery
testpaths = tests
python_files = test_*.py
python_classes = Test*
python_functions = test_*

# Output configuration
addopts = 
    --strict-markers
    --strict-config
    --verbose
    --tb=short
    --cov=planetscope_py
    --cov-report=html
    --cov-report=term-missing
    --cov-fail-under=95

# Minimum version requirements
minversion = 7.0

# Markers for test categorization
markers =
    # Core functionality tests
    unit: Unit tests for individual functions
    integration: Integration tests for multiple components  
    auth: Authentication-related tests
    validation: Input validation tests
    slow: Slow-running tests that may make network calls
    network: Tests that require network access
    config: Configuration tests
    utils: Utility tests
    exceptions: Exception tests
    
    # Planet API Integration tests  
    query: Planet API query system tests
    metadata: Metadata processing tests
    rate_limit: Rate limiting and retry logic tests
    mock_api: Tests using mock Planet API
    api: Tests that require real Planet API key
    
    # Spatial Analysis Engine tests (v3.0.0)
    spatial: Spatial analysis engine tests
    density: Density calculation tests
    rasterization: Rasterization method tests
    vector_overlay: Vector overlay method tests
    adaptive_grid: Adaptive grid method tests
    performance: Performance optimization tests
    method_selection: Automatic method selection tests
    
    # Visualization tests (v3.0.0)
    visualization: Visualization and plotting tests
    export: Export functionality tests
    geotiff: GeoTIFF export tests
    plotting: Matplotlib plotting tests
    
    # Performance and benchmarking
    benchmark: Performance benchmark tests
    memory: Memory usage tests
    large_dataset: Tests with large datasets
    high_resolution: High-resolution grid tests

# Test filtering
filterwarnings =
    ignore::DeprecationWarning
    ignore::PendingDeprecationWarning
    ignore:.*shapely.*:UserWarning
    ignore:.*mock.*:UserWarning
    # Spatial analysis warnings (v3.0.0)
    ignore:.*rasterio.*:UserWarning
    ignore:.*geopandas.*:FutureWarning
    ignore:.*matplotlib.*:UserWarning
    ignore:.*PROJ.*:UserWarning
    ignore:.*CRS.*:UserWarning

# Logging configuration for tests
log_cli = false
log_cli_level = INFO
log_cli_format = %(asctime)s [%(levelname)8s] %(name)s: %(message)s
log_cli_date_format = %Y-%m-%d %H:%M:%S

# Coverage configuration
[coverage:run]
source = planetscope_py
omit = 
    */tests/*
    */test_*
    */__pycache__/*
    */venv/*
    */env/*
    */myvenv/*
    */.pytest_temp/*
    */site-packages/*
    */build/*
    */dist/*

[coverage:report]
exclude_lines =
    pragma: no cover
    def __repr__
    if self.debug:
    if settings.DEBUG
    raise AssertionError
    raise NotImplementedError
    if 0:
    if __name__ == .__main__.:
    class .*\bProtocol\):
    @(abc\.)?abstractmethod
    # Spatial analysis exclusions
    except ImportError:
    except ModuleNotFoundError:
    if not _SPATIAL_ANALYSIS_AVAILABLE:
    if not _VISUALIZATION_AVAILABLE:

[coverage:html]
directory = htmlcov
title = PlanetScope-py v3.0.0 Coverage Report

[coverage:xml]
output = coverage.xml